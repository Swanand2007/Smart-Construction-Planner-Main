<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üèóÔ∏è Smart Construction Planner</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
            min-height: 100vh;
            color: white;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        h1 { font-size: 2.5em; margin-bottom: 10px; }
        .project-badge {
            background: rgba(255,255,255,0.2);
            padding: 8px 20px;
            border-radius: 25px;
            font-size: 0.9em;
            display: inline-block;
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 40px 20px; }
        .form-section {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 40px;
            border: 1px solid rgba(255,255,255,0.2);
        }
        .input-group { margin-bottom: 25px; text-align: left; }
        label { display: block; margin-bottom: 10px; font-weight: 600; font-size: 1.05em; }
        .hint { font-size: 0.8em; opacity: 0.85; margin-top: 4px; }
        input, select {
            width: 100%; padding: 18px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 15px; font-size: 16px;
            background: rgba(255,255,255,0.1); color: white;
            backdrop-filter: blur(10px); transition: all 0.3s;
        }
        .inline-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            font-size: 0.9em;
        }
        .inline-options label {
            display: flex;
            align-items: center;
            gap: 4px;
            font-weight: 500;
            margin-bottom: 0;
        }
        .inline-options input[type="checkbox"],
        .inline-options input[type="radio"] {
            width: auto;
        }
        #direction {
            background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%) !important;
            border-color: #4ecdc4 !important;
            box-shadow: 0 0 20px rgba(78, 205, 196, 0.3);
        }
        #direction:focus {
            border-color: #4ecdc4 !important;
            box-shadow: 0 0 25px rgba(78, 205, 196, 0.5) !important;
        }
        input::placeholder { color: #ccc; }
        input:focus, select:focus {
            outline: none; border-color: #667eea;
            box-shadow: 0 0 20px rgba(102,126,234,0.4);
            transform: translateY(-2px);
        }
        button {
            width: 100%; padding: 20px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white; border: none; border-radius: 15px;
            font-size: 20px; font-weight: bold; cursor: pointer;
            transition: all 0.3s;
        }
        button:hover { transform: translateY(-5px); box-shadow: 0 15px 35px rgba(240,147,251,0.4); }
        .result-section {
            display: none;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            border: 1px solid rgba(255,255,255,0.2);
            animation: slideIn 0.8s ease-out;
        }
        .result-section.show { display: block; }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .result-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .result-card {
            background: rgba(255,255,255,0.15);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            border-left: 5px solid #667eea;
        }
        .result-card h3 { color: #f093fb; margin-bottom: 15px; font-size: 1.25em; }
        .preview-section { margin: 40px 0; }
        .preview-section h2 {
            text-align: center; margin-bottom: 30px;
            font-size: 2.2em; color: #4ecdc4;
            background: rgba(78,205,196,0.2);
            padding: 15px 30px; border-radius: 25px; display: inline-block;
        }
        .preview-main {
            background: rgba(255,255,255,0.15);
            border-radius: 20px; padding: 40px;
            text-align: center; margin-bottom: 30px;
            border: 2px solid rgba(78,205,196,0.4);
            position: relative; overflow: hidden;
            cursor: pointer; transition: all 0.4s;
        }
        .preview-main:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 25px 50px rgba(78,205,196,0.3);
            border-color: #4ecdc4;
        }
        .preview-main::before {
            content: 'üëÅÔ∏è Tap for 3D View';
            position: absolute; top: 20px; right: 20px;
            background: rgba(78,205,196,0.9);
            padding: 10px 20px; border-radius: 25px;
            font-weight: bold; opacity: 0; transition: opacity 0.3s;
        }
        .preview-main:hover::before { opacity: 1; }
        .preview-visual {
            width: 100%; height: 260px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #4ecdc4 100%);
            border-radius: 15px; margin: 20px 0;
            display: flex; align-items: center; justify-content: center;
            font-size: 3.5em; position: relative;
        }
        .preview-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px; margin-top: 25px;
        }
        .preview-feature {
            background: rgba(0,0,0,0.3);
            padding: 20px; border-radius: 12px; text-align: center;
        }
        .preview-feature h4 { color: #4ecdc4; margin-bottom: 10px; }
        .sub-section {
            background: rgba(0,0,0,0.35);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            font-size: 0.92em;
        }
        .sub-section h3 {
            margin-bottom: 10px;
            color: #4ecdc4;
        }
        .sub-section ul {
            margin-left: 18px;
            line-height: 1.5;
        }
        .sub-section p {
            line-height: 1.5;
        }
        .modal {
            display: none; position: fixed; z-index: 1000;
            left: 0; top: 0; width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.95); animation: fadeIn 0.3s;
        }
        .modal.show { display: flex !important; align-items: center; justify-content: center; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .modal-content {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            margin: 2%; padding: 20px; border-radius: 20px;
            max-width: 1000px; width: 96%; max-height: 90vh;
            overflow-y: auto; position: relative;
            border: 1px solid rgba(255,255,255,0.2);
        }
        .close {
            position: absolute; right: 10px; top: 10px;
            font-size: 32px; cursor: pointer; color: white;
            width: 40px; height: 40px;
            display: flex; align-items: center; justify-content: center;
            background: rgba(255,255,255,0.1); border-radius: 50%;
            transition: all 0.3s;
        }
        .close:hover { background: #f093fb; transform: rotate(90deg); }
        .model-images {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 15px; margin: 20px 0;
        }
        .model-image {
            width: 100%; height: 220px;
            border-radius: 15px; object-fit: cover;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            transition: transform 0.3s;
        }
        .model-image:hover { transform: scale(1.03); }
        .model-title { text-align: center; font-size: 1.7em; margin: 10px 0 5px; color: #4ecdc4; }
        .cost-breakdown {
            background: rgba(0,0,0,0.3);
            padding: 25px; border-radius: 15px;
            margin: 30px 0; text-align: center;
        }
        .cost-breakdown table {
            width: 100%; border-collapse: collapse; margin-top: 15px;
        }
        .cost-breakdown th, .cost-breakdown td {
            padding: 12px; text-align: left;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .pdf-btn {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white; padding: 18px 40px;
            border-radius: 25px; border: none;
            font-size: 18px; font-weight: bold;
            cursor: pointer; display: block;
            margin: 30px auto; transition: all 0.3s;
        }
        .pdf-btn:hover { transform: translateY(-3px); box-shadow: 0 10px 25px rgba(240,147,251,0.5); }
        .back-btn {
            display: inline-block; padding: 15px 40px;
            background: rgba(255,255,255,0.2); color: white;
            text-decoration: none; border-radius: 25px;
            transition: all 0.3s; backdrop-filter: blur(10px);
        }
        .back-btn:hover { background: rgba(255,255,255,0.3); transform: translateY(-3px); }
        .share-box {
            margin-top: 15px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            font-size: 0.85em;
            align-items: center;
        }
        .share-box button {
            width: auto;
            padding: 10px 18px;
            font-size: 0.9em;
        }
        .share-box small {
            opacity: 0.85;
        }
        .about-btn {
            margin-top: 10px;
            display: inline-block;
            padding: 8px 18px;
            border-radius: 20px;
            border: none;
            background: rgba(0,0,0,0.25);
            color: #fff;
            font-size: 0.8em;
            cursor: pointer;
        }
        .about-btn:hover {
            background: rgba(0,0,0,0.4);
        }
        @media (max-width: 768px) {
            .container { padding: 20px; }
            .form-section, .result-section { padding: 25px; }
            h1 { font-size: 2em; }
            .preview-info-grid { grid-template-columns: 1fr; }
            .model-images { grid-template-columns: 1fr; }
            .preview-visual { height: 220px; font-size: 3em; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üèóÔ∏è Smart Construction Planner</h1>
        <div class="project-badge">Interactive Plot Analysis & Cost Estimation Tool</div>
        <p style="margin-top:10px;font-size:0.95em;opacity:0.9;">
            AI‚Äëassisted plot analysis and residential construction planning with instant cost estimation.
        </p>
        <div style="margin-top:12px;display:flex;gap:10px;justify-content:center;flex-wrap:wrap;">
            <span style="padding:4px 10px;border-radius:12px;background:rgba(0,0,0,0.2);font-size:0.8em;">
                ‚öôÔ∏è AI‚ÄëInspired Rule Engine
            </span>
            <span style="padding:4px 10px;border-radius:12px;background:rgba(0,0,0,0.2);font-size:0.8em;">
                üí∞ Auto Cost Estimator
            </span>
            <span style="padding:4px 10px;border-radius:12px;background:rgba(0,0,0,0.2);font-size:0.8em;">
                üß≠ Vastu‚ÄëAware Orientation
            </span>
            <span style="padding:4px 10px;border-radius:12px;background:rgba(0,0,0,0.2);font-size:0.8em;">
                üå± Sustainability & Smart‚ÄëHome Hints
            </span>
        </div>
       <button class="about-btn" type="button"
        onclick="window.location.href='team.html';">
    üë• About / Team
</button>


    </div>

    <div class="container">
        <div id="formSection" class="form-section">
            <h2>üìê Enter Plot & Lifestyle Details</h2>
            <form id="constructionForm">
                <div class="input-group">
                    <label>Plot Length (ft):</label>
                    <input type="number" id="length" step="0.1" min="10" max="200" placeholder="Enter length" required>
                </div>
                <div class="input-group">
                    <label>Plot Width (ft):</label>
                    <input type="number" id="width" step="0.1" min="10" max="200" placeholder="Enter width" required>
                </div>
                <div class="input-group">
                    <label>üß≠ Facing Direction:</label>
                    <select id="direction" required>
                        <option value="">Select Direction</option>
                        <option value="East">East (Vastu Positive)</option>
                        <option value="North">North (Prosperity)</option>
                        <option value="South">South (Energy)</option>
                        <option value="West">West (Stability)</option>
                    </select>
                </div>

                <div class="input-group">
                    <label>üìç Region / City (for local cost):</label>
                    <select id="region" required>
                        <option value="">Select Region</option>
                        <option value="Tier3">Smaller City / Tier‚Äë3 (e.g., Kota)</option>
                        <option value="Tier2">Tier‚Äë2 City</option>
                        <option value="Metro">Metro / Tier‚Äë1</option>
                    </select>
                    <div class="hint">Rates per sq.ft automatically adjust based on region band.</div>
                </div>

                <div class="input-group">
                    <label>Budget (‚Çπ):</label>
                    <input type="number" id="budget" min="500000" max="50000000" placeholder="Total budget" required>
                    <div class="hint">Planner will try to keep total (civil + interior + architecture) around this value.</div>
                </div>

                <div class="input-group">
                    <label>üë®‚Äçüë©‚Äçüëß Lifestyle & Usage:</label>
                    <div class="inline-options">
                        <label><input type="checkbox" id="hostGuests"> I regularly host guests</label>
                        <label><input type="checkbox" id="workFromHome"> I work from home</label>
                        <label><input type="checkbox" id="kids"> Kids at home</label>
                        <label><input type="checkbox" id="elderly"> Elderly parents at home</label>
                    </div>
                    <div class="hint">These preferences influence suggested layout, room focus and circulation.</div>
                </div>

                <div class="input-group">
                    <label>üîÆ Future Expansion Priority:</label>
                    <div class="inline-options">
                        <label><input type="radio" name="expansion" value="none" checked> No expansion</label>
                        <label><input type="radio" name="expansion" value="vertical"> Plan for future extra floor</label>
                        <label><input type="radio" name="expansion" value="horizontal"> Plan for future room extension</label>
                    </div>
                </div>

                <button type="submit">üöÄ Generate Complete Smart Plan</button>
                <div style="margin-top:25px;display:flex;flex-wrap:wrap;gap:10px;font-size:0.85em;opacity:0.9;">
                    <div style="flex:1 1 150px;">‚ë† Enter plot size, region, facing direction, budget and lifestyle.</div>
                    <div style="flex:1 1 150px;">‚ë° Engine applies rules for house‚Äëtype, local cost, Vastu, lifestyle and future expansion.</div>
                    <div style="flex:1 1 150px;">‚ë¢ Get suggested house category, layout preview, cost, sustainability and smart‚Äëhome hints.</div>
                </div>
            </form>
        </div>

        <div id="resultSection" class="result-section">
            <div class="result-grid">
                <div class="result-card">
                    <h3>üìè Total Area</h3>
                    <div id="areaResult" style="font-size: 2em; font-weight: bold; color: #4ecdc4;">0 sq.ft</div>
                </div>
                <div class="result-card">
                    <h3>üè† House Type</h3>
                    <div id="houseTypeResult"></div>
                </div>
                <div class="result-card">
                    <h3>üß≠ Architecture</h3>
                    <div id="architectureResult"></div>
                </div>
                <div class="result-card">
                    <h3>üé® Interior</h3>
                    <div id="interiorResult"></div>
                </div>
            </div>

            <div class="sub-section">
                <h3>üìå Key Highlights</h3>
                <ul>
                    <li>Automatically classifies house type (1BHK / 2BHK / Duplex) from available plot area.</li>
                    <li>Applies simple Vastu‚Äëaware orientation rules based on facing direction.</li>
                    <li>Adjusts construction / interior rate bands using region and budget to stay closer to target cost.</li>
                    <li>Provides lifestyle‚Äëbased layout notes, sustainability tips, smart‚Äëhome ideas and expansion advice.</li>
                </ul>
            </div>

            <div class="preview-section">
                <h2>üè° Expected House Structure Preview</h2>
                <div class="preview-main" onclick="open3DPreview()">
                    <div class="preview-visual" id="previewVisual">
                        üè† <div style="font-size: 0.3em; margin-top: 10px;">Tap for 3D References</div>
                    </div>
                    <h3 id="previewTitle" style="color: #4ecdc4; margin: 20px 0;">House Structure Loading...</h3>
                    <div id="previewDesc" style="font-size: 1.2em; margin-bottom: 25px; color: #ddd;"></div>
                    <div class="preview-info-grid">
                        <div class="preview-feature">
                            <h4>üìè Rooms Possible</h4>
                            <div id="roomsCount">Loading...</div>
                        </div>
                        <div class="preview-feature">
                            <h4>üö™ Entrances</h4>
                            <div id="entrances">Loading...</div>
                        </div>
                        <div class="preview-feature">
                            <h4>üåû Windows</h4>
                            <div id="windows">Loading...</div>
                        </div>
                        <div class="preview-feature">
                            <h4>üõèÔ∏è Parking</h4>
                            <div id="parking">Loading...</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="sub-section" id="lifestyleSummarySection">
                <h3>üë®‚Äçüë©‚Äçüëß Lifestyle‚ÄëBased Suggestions</h3>
                <p id="lifestyleSummaryText"></p>
            </div>

            <div class="sub-section" id="sustainabilitySection">
                <h3>üå± Sustainability & Energy Efficiency</h3>
                <ul id="sustainabilityList"></ul>
            </div>

            <div class="sub-section" id="expansionSection">
                <h3>üìà Future Expansion Planning</h3>
                <p id="expansionText"></p>
            </div>

            <div class="sub-section" id="smartHomeSection">
                <h3>üì° Smart‚ÄëHome Readiness</h3>
                <ul id="smartHomeList"></ul>
            </div>

            <div class="cost-breakdown">
                <h3>üí∞ Detailed Cost Estimation</h3>
                <table>
                    <tr><th>Item</th><th>Rate/sq.ft</th><th>Total</th></tr>
                    <tr><td>Construction</td><td id="constRate">‚Çπ1,800</td><td id="constTotal">‚Çπ0</td></tr>
                    <tr><td>Interior</td><td id="intRate">‚Çπ800</td><td id="intTotal">‚Çπ0</td></tr>
                    <tr><td>Architecture</td><td id="archRate">‚Çπ300</td><td id="archTotal">‚Çπ0</td></tr>
                    <tr><td><strong>Total</strong></td><td></td><td id="grandTotal">‚Çπ0</td></tr>
                </table>
                <div id="budgetNote" style="margin-top:10px;font-size:0.85em;opacity:0.9;"></div>
            </div>

            <div class="sub-section">
                <h3>üåê Share With Architect / Friends</h3>
                <div class="share-box">
                    <button type="button" onclick="copySummary()">Copy Summary Text</button>
                    <a id="waShare" target="_blank" style="text-decoration:none;">
                        <button type="button">Share via WhatsApp</button>
                    </a>
                    <small id="copyStatus"></small>
                </div>
            </div>

            <div style="text-align: center;">
                <button class="pdf-btn" onclick="openPdfPage()">üì• Download Complete PDF Report</button>
            </div>

            <a href="#" id="backBtn" class="back-btn">‚Üê Generate New Plan</a>
        </div>

        <div id="teamSection" style="margin-top:30px;background:rgba(0,0,0,0.4);border-radius:16px;padding:18px;font-size:0.9em;line-height:1.6;">
            <h3 style="margin-bottom:8px;color:#4ecdc4;">‚ÑπÔ∏è About This Project</h3>
            <p>
                Smart Construction Planner is a final‚Äëyear academic project that helps users quickly analyse a residential plot,
                estimate realistic construction cost, and understand possible house types before meeting an architect.
            </p>
            <p>
                The tool combines simple rule‚Äëbased logic for AI‚Äëlike suggestions with local‚Äëstyle cost bands, lifestyle‚Äëbased
                hints, sustainability ideas, and smart‚Äëhome readiness notes, so planning feels practical, not just visual.
            </p>

         

        </div>

        <div id="modelModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="close3DPreview()">&times;</span>
                <h2 class="model-title" id="modalTitle">3D House References</h2>
                <div class="model-images" id="modelImages"></div>
                <div style="text-align: center; margin-top: 10px; color: #ccc; font-size: 0.95em;">
                    <p>Tap any image to open it in a new tab and zoom.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentData = {};
        const bhkImages = {
            "1BHK": [
                "https://images.unsplash.com/photo-1600607686109-040b5619a8e1?w=800&h=500&fit=crop",
                "https://images.unsplash.com/photo-1583608205776-bfd35f931b9d?w=800&h=500&fit=crop",
                "https://images.unsplash.com/photo-1564013799919-ab600027ffc6?w=800&h=500&fit=crop"
            ],
            "2BHK": [
                "https://images.unsplash.com/photo-1600566752355-357079c1b6d3?w=800&h=500&fit=crop",
                "https://images.unsplash.com/photo-1600606754529-0b26b2b97e4f?w=800&h=500&fit=crop",
                "https://images.unsplash.com/photo-1571896349840-f9d4f55e9e6b?w=800&h=500&fit=crop"
            ],
            "Duplex": [
                "https://images.unsplash.com/photo-1558618047-3c8c76ca3350?w=800&h=500&fit=crop",
                "https://images.unsplash.com/photo-1600585154340-be6161a56a0c?w=800&h=500&fit=crop",
                "https://images.unsplash.com/photo-1570129477492-45c003edd2be?w=800&h=500&fit=crop"
            ]
        };

        function getRegionFactor(region) {
            if (region === "Tier3") return 0.9;
            if (region === "Tier2") return 1.0;
            if (region === "Metro") return 1.2;
            return 1.0;
        }

        document.getElementById('constructionForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const length = parseFloat(document.getElementById('length').value);
            const width = parseFloat(document.getElementById('width').value);
            const direction = document.getElementById('direction').value;
            const region = document.getElementById('region').value;
            const budget = parseFloat(document.getElementById('budget').value);

            const hostGuests = document.getElementById('hostGuests').checked;
            const workFromHome = document.getElementById('workFromHome').checked;
            const kids = document.getElementById('kids').checked;
            const elderly = document.getElementById('elderly').checked;
            const expansion = document.querySelector('input[name="expansion"]:checked').value;

            const area = length * width;

            let houseType = area < 800 ? "1BHK Compact House" :
                           area <= 1500 ? "2BHK Family House" : "Duplex / Villa";

            let architecture = direction === "East" ? "Modern East-Facing (Living East)" :
                             direction === "North" ? "Vastu North-Facing Design" :
                             direction === "South" ? "Contemporary South Design" :
                             "Minimalist West-Facing";

            let interior = budget < 1000000 ? "Budget Minimal" :
                         budget <= 3000000 ? "Modern Modular" : "Luxury Premium";

            const regionFactor = getRegionFactor(region);

            let baseConstRate = area < 800 ? 1600 : area <= 1500 ? 1800 : 2200;
            let baseIntRate = budget < 1000000 ? 600 : budget <= 3000000 ? 900 : 1500;
            let archRate = 300;

            let constRate = Math.round(baseConstRate * regionFactor);
            let intRate = Math.round(baseIntRate * regionFactor);

            const rawTotal = area * (constRate + intRate + archRate);

            let budgetNote = "";
            if (rawTotal > budget * 1.15) {
                constRate = Math.round(constRate * 0.9);
                intRate = Math.round(intRate * 0.85);
                budgetNote = "‚ö†Ô∏è Plan is above budget, so engine suggested slightly lower material / interior band to move total closer to your target.";
            } else if (rawTotal < budget * 0.8) {
                intRate = Math.round(intRate * 1.1);
                budgetNote = "‚ÑπÔ∏è Your budget allows better interior finish; suggesting a slightly higher interior band.";
            } else {
                budgetNote = "‚úÖ Estimated total is roughly aligned with your entered budget band.";
            }

            currentData = {
                area, length, width, direction, budget, region,
                houseType, architecture, interior,
                constRate, intRate, archRate, houseKey: houseType.split(' ')[0],
                hostGuests, workFromHome, kids, elderly, expansion
            };

            document.getElementById('areaResult').textContent = `${area.toFixed(2)} sq.ft`;
            document.getElementById('houseTypeResult').innerHTML = `<strong>${houseType}</strong>`;
            document.getElementById('architectureResult').innerHTML = `<strong>${architecture}</strong>`;
            document.getElementById('interiorResult').innerHTML = `<strong>${interior}</strong>`;

            document.getElementById('constRate').textContent = `‚Çπ${constRate}`;
            document.getElementById('intRate').textContent = `‚Çπ${intRate}`;
            document.getElementById('archRate').textContent = `‚Çπ${archRate}`;
            const constTotal = area * constRate;
            const intTotal = area * intRate;
            const archTotal = area * archRate;
            const grandTotal = constTotal + intTotal + archTotal;

            document.getElementById('constTotal').textContent = `‚Çπ${constTotal.toLocaleString()}`;
            document.getElementById('intTotal').textContent = `‚Çπ${intTotal.toLocaleString()}`;
            document.getElementById('archTotal').textContent = `‚Çπ${archTotal.toLocaleString()}`;
            document.getElementById('grandTotal').textContent = `‚Çπ${grandTotal.toLocaleString()}`;
            document.getElementById('budgetNote').textContent = budgetNote;

            const houseKey = houseType.split(' ')[0];
            let previewData;

            if (houseKey === "1BHK") {
                if (area <= 400) {
                    previewData = {
                        title: "Ultra‚ÄëCompact 1BHK Studio",
                        desc: "Combined bedroom + living zone (~180 sq.ft), compact kitchen (~60 sq.ft), common bath (~40 sq.ft), multipurpose space (~80 sq.ft). Best for single user or very compact usage.",
                        rooms: "Studio (Bed + Living) + 1 Bath + Kitchen",
                        entrances: "1 Main Door",
                        windows: "2 Windows",
                        parking: "Scooter / Bike"
                    };
                } else if (area <= 600) {
                    previewData = {
                        title: "Compact 1BHK Layout",
                        desc: "Single bedroom (~150 sq.ft) + attached/common bath, open kitchen (~70‚Äì80 sq.ft), living‚Äëdining (~150‚Äì180 sq.ft), small sit‚Äëout/balcony. Suitable for young couples / small families.",
                        rooms: "1 Bed + 1 Bath + Kitchen + Living",
                        entrances: "1 Main Door (can be East/North facing)",
                        windows: "3‚Äì4 Windows",
                        parking: "2‚ÄëWheeler"
                    };
                } else {
                    previewData = {
                        title: "Spacious 1BHK Premium Layout",
                        desc: "Large bedroom (~170‚Äì190 sq.ft) with wardrobe space, attached bath, L‚Äëshaped kitchen (~90 sq.ft), separate dining + living (~200 sq.ft), balcony / utility (~60‚Äì80 sq.ft).",
                        rooms: "1 Large Bed + 1 Bath + Kitchen + Dining + Living",
                        entrances: "1 Main Door + Service/Utility Access",
                        windows: "4‚Äì5 Windows + Balcony",
                        parking: "Car (compact) + 2‚ÄëWheeler"
                    };
                }
            } else if (houseKey === "2BHK") {
                previewData = {
                    title: "Spacious 2BHK Family Home",
                    desc: "Master bedroom (~200 sq.ft) + ensuite, guest bedroom (~150 sq.ft), pooja (~30 sq.ft), modular kitchen (~100 sq.ft), dining‚Äëliving (~300 sq.ft), 1‚Äì2 balconies.",
                    rooms: "2 Bed + 2 Bath + Pooja + Kitchen + Dining",
                    entrances: "Main + Optional Service Entry",
                    windows: "8 Windows + 1‚Äì2 Balconies",
                    parking: "Car + 2‚ÄëWheeler"
                };
            } else {
                previewData = {
                    title: "Luxury Duplex Villa",
                    desc: "3 bedrooms (approx. 250/200/150 sq.ft) with attached baths, living room (~400 sq.ft), family lounge (~200 sq.ft), kitchen (~150 sq.ft), terrace garden (~300 sq.ft), optional home theatre.",
                    rooms: "3 Bed + 4 Bath + Lounge + Theatre",
                    entrances: "Grand Main + Service Door",
                    windows: "12 Large Windows + Terrace Access",
                    parking: "2 Cars + 2‚ÄëWheelers"
                };
            }

            document.getElementById('previewTitle').textContent = previewData.title;
            document.getElementById('previewDesc').textContent = previewData.desc;
            document.getElementById('roomsCount').textContent = previewData.rooms;
            document.getElementById('entrances').textContent = previewData.entrances;
            document.getElementById('windows').textContent = previewData.windows;
            document.getElementById('parking').textContent = previewData.parking;

            buildLifestyleSummary(currentData);
            buildSustainabilityHints(currentData);
            buildExpansionAdvice(currentData);
            buildSmartHomeHints(currentData);
            buildShareLinks(currentData, grandTotal);

            document.getElementById('formSection').style.display = 'none';
            document.getElementById('resultSection').classList.add('show');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        function buildLifestyleSummary(data) {
            let parts = [];
            if (data.hostGuests) parts.push("larger living / dining space and guest‚Äëfriendly circulation");
            if (data.workFromHome) parts.push("a quiet corner or dedicated workspace near natural light");
            if (data.kids) parts.push("safe movement paths and a small play / study zone");
            if (data.elderly) parts.push("ground‚Äëfloor bedroom and minimal level changes");

            const el = document.getElementById('lifestyleSummaryText');
            if (parts.length === 0) {
                el.textContent = "Standard circulation with balanced bedroom and living sizes. You can refine requirements with your architect for more personalization.";
            } else {
                el.textContent = "Planner recommends giving priority to " + parts.join(", ") + ". These priorities can be reflected while finalizing the detailed floor plan.";
            }
        }

        function buildSustainabilityHints(data) {
            const list = document.getElementById('sustainabilityList');
            const items = [];

            if (data.direction === "East" || data.direction === "North") {
                items.push("Orient living / work zones to the East/North side for softer daylight and reduced artificial lighting needs.");
            } else {
                items.push("Use shading devices and light‚Äëcoloured exterior paint on South/West walls to cut heat gain.");
            }

            items.push("Provide roof‚Äëtop solar panel provision; for a typical 2‚Äì3 kW system you can target noticeable savings in electricity bills over 7‚Äì8 years.");
            items.push("Plan rainwater harvesting pit near setback area; harvested water can support borewell recharge and gardening.");
            items.push("Cross‚Äëventilation: keep opposite‚Äëside windows in living and bedrooms wherever plot shape allows.");
            items.push("Use LED lighting and efficient fans/ACs to reduce running cost of the house.");

            list.innerHTML = items.map(x => `<li>${x}</li>`).join("");
        }

        function buildExpansionAdvice(data) {
            const el = document.getElementById('expansionText');
            const area = data.area;
            let text;

            if (data.expansion === "none") {
                text = "Expansion not prioritised. Current house can be fully optimised for present usage, with only basic structural margin for minor future changes.";
            } else if (data.expansion === "vertical") {
                text = "Keep structural design and column layout ready for one extra floor. Discuss higher foundation / column sizes with structural engineer so that future first‚Äëfloor addition is simpler.";
            } else {
                text = "Reserve side / rear setback as potential zone for adding one room or extending living area later. Keep plumbing and electrical routes planned so extension is easier.";
            }

            if (area < 600) {
                text += " Since the plot is compact, vertical growth (adding another floor) is usually more practical than horizontal expansion.";
            } else if (area > 1500) {
                text += " The larger plot size allows both garden space and future built‚Äëup addition if required.";
            }

            el.textContent = text;
        }

        function buildSmartHomeHints(data) {
            const list = document.getElementById('smartHomeList');
            const items = [];

            items.push("Concealed conduits for future smart switches and dimmers in living room and master bedroom.");
            items.push("Wi‚ÄëFi router point kept near centre of the house to improve smart‚Äëdevice connectivity.");
            items.push("Door‚Äëbell and main gate provision suitable for video door‚Äëphone or smart lock in future.");
            items.push("Camera points at parking / main gate corners, with separate power socket nearby.");
            if (data.budget > 2500000) {
                items.push("Budget band allows basic smart‚Äëlighting and a few sensors (motion / door) from the start.");
            } else {
                items.push("Even with a modest budget, empty conduits and proper power points keep smart‚Äëhome upgrade ready for later.");
            }

            list.innerHTML = items.map(x => `<li>${x}</li>`).join("");
        }

        function buildShareLinks(data, grandTotal) {
            const summary =
`Smart Construction Planner Summary:
Plot: ${data.length} ft x ${data.width} ft (${data.area.toFixed(0)} sq.ft)
Facing: ${data.direction}, Region band: ${data.region}
Suggested house type: ${data.houseType}
Interior level: ${data.interior}
Approx. total cost: ‚Çπ${grandTotal.toLocaleString()}

Lifestyle focus: ${data.hostGuests ? "Hosts guests, " : ""}${data.workFromHome ? "Work-from-home, " : ""}${data.kids ? "Kids, " : ""}${data.elderly ? "Elderly, " : ""}`;

            currentData.shareSummary = summary;

            const waUrl = "https://wa.me/?text=" + encodeURIComponent(summary);
            document.getElementById('waShare').href = waUrl;
        }

        function copySummary() {
            if (!currentData.shareSummary) {
                document.getElementById('copyStatus').textContent = "Generate plan first.";
                return;
            }
            navigator.clipboard.writeText(currentData.shareSummary)
                .then(() => {
                    document.getElementById('copyStatus').textContent = "Summary copied. Paste into WhatsApp / email.";
                })
                .catch(() => {
                    document.getElementById('copyStatus').textContent = "Copy not supported in this browser.";
                });
        }

        function open3DPreview() {
            const houseKey = currentData.houseKey;
            const images = bhkImages[houseKey] || bhkImages["2BHK"];
            const imageGrid = document.getElementById('modelImages');
            imageGrid.innerHTML = images.map(img =>
                `<img src="${img}" alt="3D ${houseKey} Reference" class="model-image"
                      onclick="window.open('${img}','_blank');">`
            ).join('');
            document.getElementById('modalTitle').textContent = `${currentData.houseType} - 3D References`;
            document.getElementById('modelModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function close3DPreview() {
            document.getElementById('modelModal').classList.remove('show');
            document.body.style.overflow = 'auto';
        }

        window.addEventListener('click', function(e) {
            const modal = document.getElementById('modelModal');
            if (e.target === modal) close3DPreview();
        });

        function openPdfPage() {
            const result = document.getElementById('resultSection');
            if (!result) { alert('Please generate a plan first.'); return; }
            const clone = result.cloneNode(true);
            const previewSection = clone.querySelector('.preview-section');
            if (previewSection) previewSection.remove();
            const pdfBtn = clone.querySelector('.pdf-btn');
            if (pdfBtn) pdfBtn.remove();
            const backBtn = clone.querySelector('.back-btn');
            if (backBtn) backBtn.remove();
            const shareBox = clone.querySelector('.share-box');
            if (shareBox) shareBox.remove();
            try {
                localStorage.setItem('scp_pdf_html', clone.innerHTML);
            } catch (e) {
                alert('PDF preview not available (storage blocked on this browser).');
                return;
            }
            window.location.href = 'pdf.html';
        }

        document.getElementById('backBtn').addEventListener('click', function(e) {
            e.preventDefault();
            document.getElementById('formSection').style.display = 'block';
            document.getElementById('resultSection').classList.remove('show');
            document.getElementById('constructionForm').reset();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });
    </script>
</body>
</html>
